<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>RHUL Food Finder</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="custom.css">
    <link rel="stylesheet" href="index.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script
            src="https://code.jquery.com/jquery-3.2.1.min.js"
            integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.8/handlebars.js" integrity="sha256-1a54WaWEbX3FFsS2Ko6dUSj50JUeH/KeLY5IU2HbIBg=" crossorigin="anonymous"></script>
</head>
<body>
<!-- Always shows a header, even in smaller screens. -->
<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
    <header class="mdl-layout__header">
        <div class="mdl-layout__header-row">
            <!-- Title -->
            <span class="mdl-layout-title">RHUL Food Finder</span>
        </div>
    </header>
    <main class="mdl-layout__content">
        <div class="mdl-grid">
        <div class="mdl-layout-spacer"></div>
        <div class="mdl-cell--10-col mdl-cell mdl-grid" id="pageContent">
        </div>
        <div class="mdl-layout-spacer"></div>
        </div>
    </main>
</div>
</body>
<script>
    const DAYS = [
            "Sunday",
            "Monday",
            "Tuesday",
            "Wednesday",
            "Thursday",
            "Friday",
            "Saturday"
    ];
    Handlebars.registerHelper('time', function(arg) {
        var midnight = new Date();
        midnight.setHours(0);
        midnight.setMinutes(0);
        midnight.setSeconds(0);
        midnight.setMilliseconds(0);
        var time = new Date(midnight.getTime() + (arg * 1000));
        return time.toLocaleTimeString().substring(0,5);
    });
    $.get("data.json", function (data) {
        $.get("place.hbs", null, function (pl) {
            $.each(data, function(key, value) {
                var template = Handlebars.compile(pl);
                var newCell = $("<div/>", {
                    "class": "mdl-cell--4-col mdl-cell demo-card-wide mdl-card mdl-shadow--2dp"
                });
                newCell.html(template({
                    "location": value,
                    "hours": value["hours"][DAYS[new Date().getDay()]]
                }));
                newCell.appendTo($("#pageContent"));
            });
        }, 'html');
    });
</script>
</html>